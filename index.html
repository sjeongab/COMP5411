<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <title>COMP5411</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="style.css">
    <script type="importmap">
        {
            "imports": {
                "three": "./build/three.module.js",
                "OrbitControls": "https://unpkg.com/three@0.138.0/examples/jsm/controls/OrbitControls.js"
            }
        }
    </script>
</head>

<body>
    <div id="fps"></div>
    <div id="controls">
        <select id="modeSelect">
            <option value="plain.js">Plain</option>
            <option value="ssr.js">SSR</option>
            <option value="hybrid.js">Hybrid</option>
        </select>
    </div>
    <canvas id="canvas"></canvas>
    
    <script type="module">
        const modeSelect = document.getElementById("modeSelect");
        const canvas = document.getElementById("canvas");

        // Function to load a JavaScript file dynamically
        async function loadScript(script) {
            const existingScript = document.getElementById('dynamic-script');
            if (existingScript) {
                existingScript.parentNode.removeChild(existingScript); // Remove existing script
            }
            const newScript = document.createElement('script');
            newScript.type = 'module';
            newScript.src = script;
            newScript.id = 'dynamic-script';
            newScript.onload = function() {
                // Call the init function from the loaded script
                if (script === "plain.js") {
                    draw(canvas);
                } else if (script === "ssr.js") {
                    draw(canvas);
                } else if (script === "anotherMode.js") {
                    draw(canvas);
                }
            };
            document.body.appendChild(newScript);
        }

        // Load the default script
        loadScript(modeSelect.value);

        // Change event listener for the dropdown
        modeSelect.addEventListener("change", (event) => {
            loadScript(event.target.value); // Load the selected script
        });
    </script>
</body>
</html>